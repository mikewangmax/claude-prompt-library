<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mood Colorizer</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap');

        :root {
            --bg: #0f0f13;
            --surface: #1a1a24;
            --surface-hover: #22222e;
            --border: #2a2a3a;
            --text: #e8e8f0;
            --text-muted: #8888a0;
            --accent: #7c5cfc;
            --accent-glow: rgba(124, 92, 252, 0.3);
            --radius: 16px;
            --transition: 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        /* Ambient background */
        .ambient-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .ambient-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(120px);
            opacity: 0.15;
            transition: all 2s ease;
        }

        .ambient-orb.orb-1 {
            width: 600px;
            height: 600px;
            background: #7c5cfc;
            top: -200px;
            right: -100px;
        }

        .ambient-orb.orb-2 {
            width: 500px;
            height: 500px;
            background: #fc5c8c;
            bottom: -200px;
            left: -100px;
        }

        .ambient-orb.orb-3 {
            width: 400px;
            height: 400px;
            background: #5cfcb6;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* Main container */
        .container {
            position: relative;
            z-index: 1;
            width: 100%;
            max-width: 900px;
            padding: 40px 24px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 48px;
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3.2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #e8e8f0 0%, #7c5cfc 50%, #fc5c8c 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 12px;
            letter-spacing: -0.02em;
        }

        .header p {
            font-size: 1.1rem;
            color: var(--text-muted);
            font-weight: 300;
            max-width: 500px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Input section */
        .input-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 32px;
            margin-bottom: 32px;
            transition: border-color var(--transition);
        }

        .input-section:focus-within {
            border-color: var(--accent);
            box-shadow: 0 0 0 4px var(--accent-glow);
        }

        .input-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            margin-bottom: 12px;
        }

        .mood-input {
            width: 100%;
            background: transparent;
            border: none;
            outline: none;
            color: var(--text);
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-style: italic;
            line-height: 1.6;
            resize: none;
            min-height: 80px;
        }

        .mood-input::placeholder {
            color: #44445a;
        }

        .controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        .char-count {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .colorize-btn {
            background: linear-gradient(135deg, #7c5cfc, #9c7cfc);
            color: white;
            border: none;
            padding: 12px 32px;
            border-radius: 12px;
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .colorize-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px var(--accent-glow);
        }

        .colorize-btn:active {
            transform: translateY(0);
        }

        .colorize-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .colorize-btn .spinner {
            display: none;
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
            margin-right: 8px;
        }

        .colorize-btn.loading .spinner {
            display: inline-block;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Quick moods */
        .quick-moods {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 16px;
        }

        .quick-mood {
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-muted);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.82rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
        }

        .quick-mood:hover {
            border-color: var(--accent);
            color: var(--text);
            background: var(--surface-hover);
        }

        /* Result section */
        .result-section {
            display: none;
            animation: fadeUp 0.6s ease forwards;
        }

        .result-section.visible {
            display: block;
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .color-display {
            border-radius: var(--radius);
            overflow: hidden;
            border: 1px solid var(--border);
            margin-bottom: 24px;
        }

        .color-preview {
            height: 240px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: background-color 1s ease;
        }

        .hex-value {
            font-family: 'Inter', sans-serif;
            font-size: 3rem;
            font-weight: 700;
            letter-spacing: 0.05em;
            text-shadow: 0 2px 8px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: transform 0.2s ease;
            user-select: none;
        }

        .hex-value:hover {
            transform: scale(1.05);
        }

        .hex-value .copy-hint {
            display: block;
            font-size: 0.7rem;
            font-weight: 400;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            opacity: 0.7;
            margin-top: 4px;
        }

        .copied-toast {
            position: fixed;
            bottom: 32px;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 500;
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: none;
            z-index: 100;
        }

        .copied-toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .color-info {
            background: var(--surface);
            padding: 24px;
        }

        .color-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .color-detail {
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            padding: 14px;
        }

        .color-detail-label {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            margin-bottom: 6px;
        }

        .color-detail-value {
            font-size: 0.95rem;
            font-weight: 500;
            font-family: 'Inter', monospace;
        }

        .color-explanation {
            padding: 20px;
            background: rgba(255,255,255,0.02);
            border-radius: 12px;
            border-left: 3px solid var(--accent);
        }

        .color-explanation h3 {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-muted);
            margin-bottom: 10px;
        }

        .color-explanation p {
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text);
        }

        /* Palette harmony */
        .harmony-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 24px;
            margin-bottom: 24px;
        }

        .harmony-title {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            margin-bottom: 16px;
        }

        .harmony-swatches {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .harmony-swatch {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            border: 2px solid transparent;
        }

        .harmony-swatch:hover {
            transform: scale(1.1);
            border-color: white;
        }

        .harmony-swatch .swatch-label {
            position: absolute;
            bottom: -22px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.6rem;
            color: var(--text-muted);
            white-space: nowrap;
            font-family: monospace;
        }

        /* History */
        .history-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 24px;
            margin-bottom: 32px;
        }

        .history-title {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .clear-history {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 0.75rem;
            cursor: pointer;
            text-decoration: underline;
            font-family: 'Inter', sans-serif;
        }

        .clear-history:hover {
            color: var(--text);
        }

        .history-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .history-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 14px;
            background: rgba(255,255,255,0.02);
            border-radius: 10px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .history-item:hover {
            background: rgba(255,255,255,0.05);
        }

        .history-swatch {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            flex-shrink: 0;
        }

        .history-text {
            flex: 1;
            font-size: 0.85rem;
            color: var(--text-muted);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .history-hex {
            font-family: monospace;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text);
        }

        .history-empty {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.85rem;
            padding: 20px;
            font-style: italic;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 32px 0;
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        .footer a {
            color: var(--accent);
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 640px) {
            .header h1 {
                font-size: 2.2rem;
            }

            .mood-input {
                font-size: 1.2rem;
            }

            .hex-value {
                font-size: 2rem;
            }

            .color-preview {
                height: 180px;
            }

            .color-details {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="ambient-bg">
        <div class="ambient-orb orb-1"></div>
        <div class="ambient-orb orb-2"></div>
        <div class="ambient-orb orb-3"></div>
    </div>

    <div class="container">
        <header class="header">
            <h1>Mood Colorizer</h1>
            <p>Describe a mood or emotion and watch it transform into a color through the lens of color psychology.</p>
        </header>

        <div class="input-section">
            <label class="input-label" for="moodInput">Describe your mood</label>
            <textarea
                id="moodInput"
                class="mood-input"
                placeholder="A passionate, intense, and fiery emotion, full of love and desire..."
                maxlength="300"
            ></textarea>
            <div class="controls">
                <span class="char-count"><span id="charCount">0</span>/300</span>
                <button class="colorize-btn" id="colorizeBtn" onclick="colorize()">
                    <span class="spinner"></span>
                    Colorize
                </button>
            </div>
            <div class="quick-moods">
                <button class="quick-mood" onclick="quickMood('A passionate, intense, and fiery emotion, full of love and desire')">Passionate</button>
                <button class="quick-mood" onclick="quickMood('A calm, serene, and tranquil feeling, like floating on still water')">Serene</button>
                <button class="quick-mood" onclick="quickMood('A joyful, exuberant burst of happiness and celebration')">Joyful</button>
                <button class="quick-mood" onclick="quickMood('A deep, melancholic sadness tinged with nostalgia and longing')">Melancholic</button>
                <button class="quick-mood" onclick="quickMood('An anxious, restless energy, uncertain and on edge')">Anxious</button>
                <button class="quick-mood" onclick="quickMood('A peaceful, grounded feeling of harmony with nature')">Peaceful</button>
                <button class="quick-mood" onclick="quickMood('A mysterious, enigmatic aura of intrigue and secrecy')">Mysterious</button>
                <button class="quick-mood" onclick="quickMood('A warm, cozy feeling of comfort and safety by a fireplace')">Cozy</button>
                <button class="quick-mood" onclick="quickMood('A powerful, triumphant feeling of overcoming great obstacles')">Triumphant</button>
                <button class="quick-mood" onclick="quickMood('A gentle, tender emotion of compassion and empathy')">Compassionate</button>
            </div>
        </div>

        <div class="result-section" id="resultSection">
            <div class="color-display">
                <div class="color-preview" id="colorPreview">
                    <div class="hex-value" id="hexValue" onclick="copyHex()">
                        <span id="hexText">#FF1744</span>
                        <span class="copy-hint">Click to copy</span>
                    </div>
                </div>
                <div class="color-info">
                    <div class="color-details" id="colorDetails"></div>
                    <div class="color-explanation">
                        <h3>Color Psychology</h3>
                        <p id="explanation"></p>
                    </div>
                </div>
            </div>

            <div class="harmony-section">
                <div class="harmony-title">Color Harmonies</div>
                <div class="harmony-swatches" id="harmonies"></div>
            </div>
        </div>

        <div class="history-section" id="historySection">
            <div class="history-title">
                <span>Recent Moods</span>
                <button class="clear-history" onclick="clearHistory()">Clear all</button>
            </div>
            <div class="history-list" id="historyList">
                <div class="history-empty">Your mood colors will appear here</div>
            </div>
        </div>

        <footer class="footer">
            Mood Colorizer &mdash; built with color psychology principles<br>
            From the <a href="https://platform.claude.com/docs/en/resources/prompt-library/mood-colorizer" target="_blank">Anthropic Prompt Library</a>
        </footer>
    </div>

    <div class="copied-toast" id="copiedToast">Copied to clipboard!</div>

    <script>
        // ─── Mood-to-Color Mapping Engine ───
        // Uses keyword analysis and color psychology to map mood descriptions to HEX codes

        const moodInput = document.getElementById('moodInput');
        const charCount = document.getElementById('charCount');
        const colorizeBtn = document.getElementById('colorizeBtn');
        const resultSection = document.getElementById('resultSection');
        const colorPreview = document.getElementById('colorPreview');
        const hexText = document.getElementById('hexText');
        const explanation = document.getElementById('explanation');
        const colorDetails = document.getElementById('colorDetails');
        const harmonies = document.getElementById('harmonies');
        const historyList = document.getElementById('historyList');
        const copiedToast = document.getElementById('copiedToast');

        let history = JSON.parse(localStorage.getItem('moodHistory') || '[]');
        let currentHex = '';

        // Character count
        moodInput.addEventListener('input', () => {
            charCount.textContent = moodInput.value.length;
        });

        // Enter key to submit
        moodInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                colorize();
            }
        });

        // Keyword-to-color associations based on color psychology
        const colorKeywords = {
            // Reds - passion, love, anger, intensity
            passion: { h: 348, s: 90, l: 50 },
            passionate: { h: 348, s: 90, l: 50 },
            love: { h: 345, s: 85, l: 55 },
            desire: { h: 355, s: 92, l: 48 },
            anger: { h: 0, s: 90, l: 42 },
            angry: { h: 0, s: 90, l: 42 },
            fury: { h: 5, s: 95, l: 38 },
            rage: { h: 2, s: 95, l: 35 },
            fiery: { h: 15, s: 95, l: 52 },
            intense: { h: 350, s: 85, l: 45 },
            hot: { h: 10, s: 90, l: 50 },
            fire: { h: 18, s: 95, l: 52 },

            // Oranges - warmth, energy, enthusiasm
            warm: { h: 30, s: 85, l: 55 },
            warmth: { h: 28, s: 80, l: 55 },
            cozy: { h: 25, s: 75, l: 50 },
            comfort: { h: 30, s: 70, l: 55 },
            comfortable: { h: 30, s: 70, l: 55 },
            enthusiasm: { h: 35, s: 90, l: 55 },
            enthusiastic: { h: 35, s: 90, l: 55 },
            energy: { h: 38, s: 95, l: 55 },
            energetic: { h: 38, s: 95, l: 55 },
            fireplace: { h: 22, s: 80, l: 45 },

            // Yellows - joy, happiness, optimism
            happy: { h: 48, s: 95, l: 55 },
            happiness: { h: 48, s: 95, l: 55 },
            joy: { h: 50, s: 95, l: 55 },
            joyful: { h: 50, s: 95, l: 55 },
            exuberant: { h: 45, s: 90, l: 58 },
            cheerful: { h: 52, s: 90, l: 58 },
            optimistic: { h: 55, s: 85, l: 55 },
            celebration: { h: 42, s: 95, l: 52 },
            bright: { h: 55, s: 95, l: 60 },
            sunny: { h: 48, s: 95, l: 58 },
            playful: { h: 45, s: 90, l: 60 },

            // Greens - nature, growth, harmony, envy
            nature: { h: 130, s: 55, l: 42 },
            natural: { h: 130, s: 55, l: 42 },
            growth: { h: 135, s: 60, l: 45 },
            harmony: { h: 150, s: 50, l: 45 },
            peaceful: { h: 145, s: 45, l: 48 },
            peace: { h: 145, s: 45, l: 48 },
            grounded: { h: 120, s: 40, l: 38 },
            fresh: { h: 140, s: 65, l: 50 },
            renewal: { h: 135, s: 55, l: 48 },
            envy: { h: 115, s: 55, l: 35 },
            jealous: { h: 110, s: 55, l: 35 },
            healing: { h: 155, s: 50, l: 50 },

            // Teals/Cyans - clarity, communication
            clarity: { h: 180, s: 55, l: 48 },
            clear: { h: 185, s: 55, l: 50 },
            refreshing: { h: 175, s: 60, l: 48 },
            balanced: { h: 170, s: 45, l: 45 },

            // Blues - calm, trust, sadness
            calm: { h: 210, s: 55, l: 55 },
            serene: { h: 205, s: 50, l: 60 },
            tranquil: { h: 200, s: 50, l: 58 },
            sad: { h: 220, s: 45, l: 40 },
            sadness: { h: 220, s: 45, l: 40 },
            melancholic: { h: 225, s: 40, l: 38 },
            melancholy: { h: 225, s: 40, l: 38 },
            trust: { h: 210, s: 60, l: 50 },
            lonely: { h: 218, s: 35, l: 42 },
            longing: { h: 215, s: 40, l: 45 },
            nostalgia: { h: 225, s: 35, l: 50 },
            nostalgic: { h: 225, s: 35, l: 50 },
            contemplative: { h: 215, s: 40, l: 48 },
            still: { h: 200, s: 40, l: 55 },
            floating: { h: 200, s: 45, l: 62 },
            water: { h: 195, s: 55, l: 50 },
            ocean: { h: 205, s: 65, l: 42 },

            // Indigos - wisdom, intuition, depth
            wise: { h: 240, s: 45, l: 40 },
            wisdom: { h: 240, s: 45, l: 40 },
            deep: { h: 245, s: 50, l: 35 },
            intuition: { h: 250, s: 50, l: 42 },
            spiritual: { h: 255, s: 45, l: 45 },

            // Purples - mystery, luxury, creativity
            mysterious: { h: 275, s: 55, l: 35 },
            mystery: { h: 275, s: 55, l: 35 },
            enigmatic: { h: 280, s: 50, l: 38 },
            creative: { h: 280, s: 60, l: 50 },
            creativity: { h: 280, s: 60, l: 50 },
            luxurious: { h: 270, s: 55, l: 40 },
            magical: { h: 285, s: 65, l: 45 },
            intrigue: { h: 278, s: 50, l: 36 },
            secrecy: { h: 270, s: 40, l: 30 },

            // Pinks - tenderness, compassion, romance
            tender: { h: 335, s: 60, l: 65 },
            gentle: { h: 330, s: 55, l: 68 },
            compassion: { h: 328, s: 55, l: 62 },
            compassionate: { h: 328, s: 55, l: 62 },
            empathy: { h: 325, s: 50, l: 60 },
            romantic: { h: 340, s: 65, l: 60 },
            sweet: { h: 338, s: 60, l: 65 },
            caring: { h: 332, s: 50, l: 62 },

            // Browns/Earth tones - stability, reliability
            stable: { h: 30, s: 40, l: 35 },
            reliable: { h: 25, s: 45, l: 38 },
            earthy: { h: 35, s: 50, l: 35 },
            rustic: { h: 28, s: 55, l: 32 },

            // Grays - neutral, detached
            neutral: { h: 0, s: 0, l: 55 },
            detached: { h: 0, s: 5, l: 50 },
            empty: { h: 0, s: 0, l: 45 },
            numb: { h: 0, s: 5, l: 42 },
            bored: { h: 0, s: 5, l: 52 },

            // Blacks - dark, grief, power
            dark: { h: 240, s: 20, l: 18 },
            grief: { h: 250, s: 15, l: 20 },
            power: { h: 260, s: 30, l: 22 },
            powerful: { h: 260, s: 35, l: 28 },
            dominant: { h: 255, s: 30, l: 22 },

            // Whites/Lights - purity, innocence
            pure: { h: 45, s: 15, l: 92 },
            innocent: { h: 40, s: 20, l: 90 },
            ethereal: { h: 220, s: 30, l: 85 },
            light: { h: 50, s: 20, l: 88 },

            // Complex emotions
            anxious: { h: 55, s: 60, l: 42 },
            anxiety: { h: 55, s: 60, l: 42 },
            restless: { h: 50, s: 55, l: 45 },
            nervous: { h: 52, s: 50, l: 48 },
            uncertain: { h: 48, s: 40, l: 45 },
            triumphant: { h: 42, s: 90, l: 48 },
            triumph: { h: 42, s: 90, l: 48 },
            victorious: { h: 44, s: 95, l: 50 },
            overcoming: { h: 40, s: 85, l: 48 },
            proud: { h: 260, s: 50, l: 45 },
            pride: { h: 260, s: 50, l: 45 },
            hopeful: { h: 165, s: 55, l: 55 },
            hope: { h: 165, s: 55, l: 55 },
            excited: { h: 15, s: 90, l: 55 },
            excitement: { h: 15, s: 90, l: 55 },
            fear: { h: 260, s: 30, l: 25 },
            afraid: { h: 260, s: 30, l: 25 },
            scared: { h: 260, s: 30, l: 25 },
            disgust: { h: 80, s: 50, l: 32 },
            surprise: { h: 48, s: 85, l: 58 },
            surprised: { h: 48, s: 85, l: 58 },
            awe: { h: 240, s: 50, l: 50 },
            wonder: { h: 260, s: 55, l: 55 },
            grateful: { h: 155, s: 50, l: 52 },
            gratitude: { h: 155, s: 50, l: 52 },
            content: { h: 140, s: 35, l: 55 },
            satisfied: { h: 135, s: 35, l: 52 },
            bittersweet: { h: 310, s: 35, l: 42 },
            wistful: { h: 215, s: 30, l: 52 },
            safety: { h: 28, s: 65, l: 50 },
            safe: { h: 28, s: 65, l: 50 },
        };

        // Intensity modifiers
        const intensityUp = ['very', 'extremely', 'incredibly', 'deeply', 'intensely', 'profoundly', 'overwhelmingly', 'fiercely', 'burning', 'blazing', 'full', 'utterly', 'completely', 'great'];
        const intensityDown = ['slightly', 'somewhat', 'mildly', 'softly', 'gently', 'faintly', 'barely', 'quietly', 'subtly', 'delicately'];

        // Color psychology explanations
        const colorPsychology = {
            red: "Red is the color of passion, energy, and vitality. It stimulates the senses, raises blood pressure, and evokes strong emotions. In color psychology, red represents love, desire, power, and courage. It is attention-grabbing and commands presence.",
            orange: "Orange blends the energy of red with the cheerfulness of yellow. It represents warmth, comfort, enthusiasm, and creativity. In color psychology, orange promotes feelings of sociability, optimism, and emotional warmth. It is associated with hearth, home, and nourishment.",
            yellow: "Yellow is the color of sunshine, joy, and intellect. It stimulates mental activity and generates a sense of energy and optimism. In color psychology, yellow represents happiness, hope, and positive energy. It can inspire creativity and uplift the spirit.",
            green: "Green is the color of nature, balance, and renewal. It has a calming and harmonizing effect on the mind and body. In color psychology, green represents growth, health, and tranquility. It symbolizes safety, stability, and connection to the natural world.",
            cyan: "Cyan and teal tones represent clarity of thought, emotional balance, and open communication. They combine the calming properties of blue with the renewal energy of green. These colors evoke feelings of freshness, mental clarity, and spiritual awareness.",
            blue: "Blue is the color of depth, stability, and trust. It has a calming effect that can lower heart rate and reduce anxiety. In color psychology, blue represents serenity, wisdom, and introspection. It is associated with the sky and sea, evoking vastness and contemplation.",
            indigo: "Indigo bridges the calm of blue with the mystery of violet. It represents deep intuition, wisdom, and inner knowing. In color psychology, indigo is associated with spiritual depth, perception, and the subconscious mind. It evokes a sense of profound understanding.",
            purple: "Purple combines the stability of blue with the energy of red, creating a color of mystery, luxury, and creativity. In color psychology, purple represents imagination, spiritual awareness, and transformation. It is associated with royalty, wisdom, and the mystical.",
            pink: "Pink is the color of tenderness, compassion, and unconditional love. It has a soothing and nurturing effect on the emotions. In color psychology, pink represents gentleness, empathy, and emotional healing. It softens aggression and promotes feelings of caring.",
            brown: "Brown is the color of earth, stability, and reliability. It evokes a sense of grounding, security, and connection to the natural world. In color psychology, brown represents dependability, resilience, and honest simplicity.",
            gray: "Gray is the color of neutrality, balance, and restraint. It exists between black and white, representing the space between extremes. In color psychology, gray can indicate detachment, composure, or emotional distance. It is associated with formality and sophistication.",
            dark: "Very dark tones carry weight, depth, and gravity. They represent power, authority, and the unknown. In color psychology, dark shades can evoke mystery, sophistication, or the profound depths of complex emotions.",
            light: "Very light tones carry a sense of purity, openness, and clarity. They represent innocence, simplicity, and new beginnings. In color psychology, light shades evoke feelings of spaciousness, peace, and ethereal beauty."
        };

        function getColorFamily(h, s, l) {
            if (l < 22) return 'dark';
            if (l > 82) return 'light';
            if (s < 10) return 'gray';
            if (h < 15 || h >= 345) return 'red';
            if (h < 40) return 'orange';
            if (h < 70) return 'yellow';
            if (h < 160) return 'green';
            if (h < 190) return 'cyan';
            if (h < 240) return 'blue';
            if (h < 260) return 'indigo';
            if (h < 310) return 'purple';
            if (h < 345) return 'pink';
            return 'red';
        }

        function analyzeMood(text) {
            const lower = text.toLowerCase().replace(/[^a-z\s]/g, '');
            const words = lower.split(/\s+/);

            let totalH = 0, totalS = 0, totalL = 0;
            let matchCount = 0;
            let matchedKeywords = [];
            let intensity = 1.0;

            // Check intensity modifiers
            for (const word of words) {
                if (intensityUp.includes(word)) intensity += 0.15;
                if (intensityDown.includes(word)) intensity -= 0.15;
            }
            intensity = Math.max(0.5, Math.min(1.5, intensity));

            // Match keywords
            for (const word of words) {
                if (colorKeywords[word]) {
                    const kw = colorKeywords[word];
                    totalH += kw.h;
                    totalS += kw.s;
                    totalL += kw.l;
                    matchCount++;
                    matchedKeywords.push(word);
                }
            }

            // Also check multi-word phrases
            for (const key of Object.keys(colorKeywords)) {
                if (key.length > 3 && lower.includes(key) && !matchedKeywords.includes(key)) {
                    const kw = colorKeywords[key];
                    totalH += kw.h;
                    totalS += kw.s;
                    totalL += kw.l;
                    matchCount++;
                    matchedKeywords.push(key);
                }
            }

            if (matchCount === 0) {
                return null;
            }

            let h = Math.round(totalH / matchCount);
            let s = Math.round(totalS / matchCount * intensity);
            let l = Math.round(totalL / matchCount);

            // Adjust lightness with intensity
            if (intensity > 1) {
                s = Math.min(100, s);
                l = Math.max(20, l - Math.round((intensity - 1) * 15));
            } else if (intensity < 1) {
                s = Math.max(10, s);
                l = Math.min(85, l + Math.round((1 - intensity) * 15));
            }

            s = Math.max(0, Math.min(100, s));
            l = Math.max(5, Math.min(95, l));

            const family = getColorFamily(h, s, l);
            const psychologyText = colorPsychology[family] || colorPsychology['blue'];

            return { h, s, l, matchedKeywords, psychologyText };
        }

        function hslToHex(h, s, l) {
            s /= 100;
            l /= 100;
            const a = s * Math.min(l, 1 - l);
            const f = (n) => {
                const k = (n + h / 30) % 12;
                const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
                return Math.round(255 * color).toString(16).padStart(2, '0');
            };
            return `#${f(0)}${f(8)}${f(4)}`.toUpperCase();
        }

        function hexToRgb(hex) {
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            return { r, g, b };
        }

        function getContrastColor(hex) {
            const { r, g, b } = hexToRgb(hex);
            const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
            return luminance > 0.55 ? '#1a1a24' : '#FFFFFF';
        }

        function getComplementary(h) {
            return (h + 180) % 360;
        }

        function getAnalogous(h) {
            return [(h + 30) % 360, (h - 30 + 360) % 360];
        }

        function getTriadic(h) {
            return [(h + 120) % 360, (h + 240) % 360];
        }

        function getSplitComplementary(h) {
            return [(h + 150) % 360, (h + 210) % 360];
        }

        function quickMood(text) {
            moodInput.value = text;
            charCount.textContent = text.length;
            colorize();
        }

        function colorize() {
            const text = moodInput.value.trim();
            if (!text) return;

            colorizeBtn.classList.add('loading');
            colorizeBtn.disabled = true;

            // Simulate brief processing
            setTimeout(() => {
                const result = analyzeMood(text);

                if (!result) {
                    colorizeBtn.classList.remove('loading');
                    colorizeBtn.disabled = false;
                    alert('Unable to determine a HEX color code for the given mood. Try describing an emotion with more specific feeling words.');
                    return;
                }

                const hex = hslToHex(result.h, result.s, result.l);
                const textColor = getContrastColor(hex);
                const rgb = hexToRgb(hex);

                currentHex = hex;

                // Update ambient orbs
                document.querySelector('.orb-1').style.background = hex;
                document.querySelector('.orb-2').style.background = hslToHex(getComplementary(result.h), result.s, result.l);
                document.querySelector('.orb-3').style.background = hslToHex(getAnalogous(result.h)[0], result.s, result.l);

                // Update color preview
                colorPreview.style.backgroundColor = hex;
                hexText.textContent = hex;
                document.getElementById('hexValue').style.color = textColor;

                // Update details
                colorDetails.innerHTML = `
                    <div class="color-detail">
                        <div class="color-detail-label">HEX</div>
                        <div class="color-detail-value">${hex}</div>
                    </div>
                    <div class="color-detail">
                        <div class="color-detail-label">RGB</div>
                        <div class="color-detail-value">${rgb.r}, ${rgb.g}, ${rgb.b}</div>
                    </div>
                    <div class="color-detail">
                        <div class="color-detail-label">HSL</div>
                        <div class="color-detail-value">${result.h}°, ${result.s}%, ${result.l}%</div>
                    </div>
                    <div class="color-detail">
                        <div class="color-detail-label">Keywords</div>
                        <div class="color-detail-value">${result.matchedKeywords.join(', ')}</div>
                    </div>
                `;

                // Update explanation
                explanation.textContent = result.psychologyText;

                // Update harmonies
                const comp = getComplementary(result.h);
                const [ana1, ana2] = getAnalogous(result.h);
                const [tri1, tri2] = getTriadic(result.h);
                const [split1, split2] = getSplitComplementary(result.h);

                const harmonyColors = [
                    { h: result.h, label: 'Base', hex: hex },
                    { h: comp, label: 'Complement', hex: hslToHex(comp, result.s, result.l) },
                    { h: ana1, label: 'Analogous', hex: hslToHex(ana1, result.s, result.l) },
                    { h: ana2, label: 'Analogous', hex: hslToHex(ana2, result.s, result.l) },
                    { h: tri1, label: 'Triadic', hex: hslToHex(tri1, result.s, result.l) },
                    { h: tri2, label: 'Triadic', hex: hslToHex(tri2, result.s, result.l) },
                    { h: split1, label: 'Split', hex: hslToHex(split1, result.s, result.l) },
                    { h: split2, label: 'Split', hex: hslToHex(split2, result.s, result.l) },
                ];

                harmonies.innerHTML = harmonyColors.map(c => `
                    <div class="harmony-swatch"
                         style="background-color: ${c.hex}"
                         title="${c.label}: ${c.hex}"
                         onclick="copyToClipboard('${c.hex}')">
                        <span class="swatch-label">${c.hex}</span>
                    </div>
                `).join('');

                // Add to history
                addToHistory(text, hex);

                // Show result
                resultSection.classList.remove('visible');
                void resultSection.offsetWidth; // trigger reflow
                resultSection.classList.add('visible');

                colorizeBtn.classList.remove('loading');
                colorizeBtn.disabled = false;
            }, 600);
        }

        function copyHex() {
            copyToClipboard(currentHex);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                copiedToast.textContent = `Copied ${text} to clipboard!`;
                copiedToast.classList.add('show');
                setTimeout(() => copiedToast.classList.remove('show'), 2000);
            }).catch(() => {
                // Fallback
                const el = document.createElement('textarea');
                el.value = text;
                document.body.appendChild(el);
                el.select();
                document.execCommand('copy');
                document.body.removeChild(el);
                copiedToast.textContent = `Copied ${text} to clipboard!`;
                copiedToast.classList.add('show');
                setTimeout(() => copiedToast.classList.remove('show'), 2000);
            });
        }

        function addToHistory(text, hex) {
            history.unshift({ text, hex, timestamp: Date.now() });
            if (history.length > 10) history.pop();
            localStorage.setItem('moodHistory', JSON.stringify(history));
            renderHistory();
        }

        function clearHistory() {
            history = [];
            localStorage.removeItem('moodHistory');
            renderHistory();
        }

        function renderHistory() {
            if (history.length === 0) {
                historyList.innerHTML = '<div class="history-empty">Your mood colors will appear here</div>';
                return;
            }

            historyList.innerHTML = history.map((item, i) => `
                <div class="history-item" onclick="quickMood('${item.text.replace(/'/g, "\\'")}')">
                    <div class="history-swatch" style="background-color: ${item.hex}"></div>
                    <span class="history-text">${item.text}</span>
                    <span class="history-hex">${item.hex}</span>
                </div>
            `).join('');
        }

        // Initialize history on load
        renderHistory();

        // Auto-run the example prompt
        moodInput.value = 'A passionate, intense, and fiery emotion, full of love and desire.';
        charCount.textContent = moodInput.value.length;
        colorize();
    </script>
</body>
</html>
